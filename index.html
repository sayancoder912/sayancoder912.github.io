<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MBTI Quiz</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .question {
      margin-bottom: 20px;
    }
    canvas {
      display: block;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h1>MBTI Quiz</h1>
  <div id="form-container">
    <div class="question">
      <label>What's your name?</label>
      <input type="text" id="name" />
    </div>
    <div class="question">
      <label>What's your age?</label>
      <input type="number" id="age" />
    </div>
    <div class="question">
      <label>What's your city?</label>
      <input type="text" id="city" />
    </div>
    <h2>Answer the following questions:</h2>
    <div id="questions"></div>
    <button onclick="submitAnswers()">Submit</button>
  </div>

  <script>
    let questions = [
      { text: 'Do you prefer group activities or solo time?', trait: 'E-I' },
      { text: 'Do you focus more on details or big picture?', trait: 'S-N' },
      { text: 'Do you make decisions based on logic or emotions?', trait: 'T-F' },
      { text: 'Do you prefer schedules or spontaneity?', trait: 'J-P' },
      { text: 'Are you energized by social interactions or drained?', trait: 'E-I' },
      { text: 'Do you trust facts more than theories?', trait: 'S-N' },
      { text: 'Do you value empathy over analysis?', trait: 'T-F' },
      { text: 'Do you plan ahead or go with the flow?', trait: 'J-P' },
    ];

    let scores = {
      'E-I': 0,
      'S-N': 0,
      'T-F': 0,
      'J-P': 0,
    };

    function setupQuestions() {
      const container = document.getElementById('questions');
      questions.forEach((q, index) => {
        const div = document.createElement('div');
        div.classList.add('question');
        div.innerHTML = `
          <p>${index + 1}. ${q.text}</p>
          <label><input type="radio" name="q${index}" value="1"> Option 1</label>
          <label><input type="radio" name="q${index}" value="0"> Option 2</label>
        `;
        container.appendChild(div);
      });
    }

    function submitAnswers() {
      questions.forEach((q, index) => {
        const value = document.querySelector(`input[name='q${index}']:checked`);
        if (value) {
          scores[q.trait] += parseInt(value.value);
        }
      });

      const percentages = {
        E: (scores['E-I'] / 2) * 100,
        I: 100 - (scores['E-I'] / 2) * 100,
        S: (scores['S-N'] / 2) * 100,
        N: 100 - (scores['S-N'] / 2) * 100,
        T: (scores['T-F'] / 2) * 100,
        F: 100 - (scores['T-F'] / 2) * 100,
        J: (scores['J-P'] / 2) * 100,
        P: 100 - (scores['J-P'] / 2) * 100,
      };

      const mbti =
        (percentages.E > 50 ? 'E' : 'I') +
        (percentages.S > 50 ? 'S' : 'N') +
        (percentages.T > 50 ? 'T' : 'F') +
        (percentages.J > 50 ? 'J' : 'P');

      document.getElementById('form-container').innerHTML = `<h2>Your MBTI Type: ${mbti}</h2>`;
      drawChart(percentages);
    }

    function drawChart(percentages) {
      new p5((p) => {
        p.setup = () => {
          p.createCanvas(400, 400);
          p.noLoop();
        };

        p.draw = () => {
          p.background(240);
          drawBar(p, 'Introvert', 'Extrovert', percentages.I, percentages.E, 50);
          drawBar(p, 'Sensing', 'Intuitive', percentages.S, percentages.N, 150);
          drawBar(p, 'Thinking', 'Feeling', percentages.T, percentages.F, 250);
          drawBar(p, 'Judging', 'Perceiving', percentages.J, percentages.P, 350);
        };

        function drawBar(p, leftLabel, rightLabel, leftValue, rightValue, yPos) {
          p.textSize(12);
          p.textAlign(p.LEFT);
          p.text(leftLabel, 10, yPos);
          p.textAlign(p.RIGHT);
          p.text(rightLabel, 390, yPos);

          p.fill(200);
          p.rect(50, yPos - 10, 300, 10);

          const pos = p.map(rightValue, 0, 100, 50, 350);
          p.fill(0);
          p.ellipse(pos, yPos - 5, 10, 10);
        }
      });
    }

    setupQuestions();
  </script>
</body>
</html>
